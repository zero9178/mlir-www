<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MLIR: lib/Dialect/Linalg/Transforms/ElementwiseOpFusion.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MLIR
   &#160;<span id="projectnumber">15.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_1a25ec519b6c1121408b67cc33ce3f15.html">Dialect</a></li><li class="navelem"><a class="el" href="dir_8edb792440615361a0811a7329611599.html">Linalg</a></li><li class="navelem"><a class="el" href="dir_7e2f808e77498894ca0efbd745da2201.html">Transforms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ElementwiseOpFusion.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;utility&gt;</code><br />
<code>#include &quot;<a class="el" href="lib_2Dialect_2Linalg_2Transforms_2PassDetail_8h_source.html">PassDetail.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="AffineOps_8h_source.html">mlir/Dialect/Affine/IR/AffineOps.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dialect_2Linalg_2IR_2Linalg_8h_source.html">mlir/Dialect/Linalg/IR/Linalg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dialect_2Linalg_2Passes_8h_source.html">mlir/Dialect/Linalg/Passes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dialect_2Linalg_2Transforms_2Transforms_8h_source.html">mlir/Dialect/Linalg/Transforms/Transforms.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dialect_2Linalg_2Utils_2Utils_8h_source.html">mlir/Dialect/Linalg/Utils/Utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dialect_2SparseTensor_2IR_2SparseTensor_8h_source.html">mlir/Dialect/SparseTensor/IR/SparseTensor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="IR_2AffineExpr_8h_source.html">mlir/IR/AffineExpr.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="IR_2AffineMap_8h_source.html">mlir/IR/AffineMap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Matchers_8h_source.html">mlir/IR/Matchers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PatternMatch_8h_source.html">mlir/IR/PatternMatch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Support_2LLVM_8h_source.html">mlir/Support/LLVM.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="GreedyPatternRewriteDriver_8h_source.html">mlir/Transforms/GreedyPatternRewriteDriver.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ElementwiseOpFusion.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ElementwiseOpFusion_8cpp__incl.png" border="0" usemap="#lib_2Dialect_2Linalg_2Transforms_2ElementwiseOpFusion_8cpp" alt=""/></div>
<map name="lib_2Dialect_2Linalg_2Transforms_2ElementwiseOpFusion_8cpp" id="lib_2Dialect_2Linalg_2Transforms_2ElementwiseOpFusion_8cpp">
<area shape="rect" id="node3" href="lib_2Dialect_2Linalg_2Transforms_2PassDetail_8h.html" title="PassDetail.h" alt="" coords="1147,281,1249,307"/>
<area shape="rect" id="node4" href="AffineOps_8h.html" title="mlir/Dialect/Affine\l/IR/AffineOps.h" alt="" coords="1128,363,1268,404"/>
<area shape="rect" id="node6" href="IR_2AffineMap_8h.html" title="mlir/IR/AffineMap.h" alt="" coords="4226,638,4373,665"/>
<area shape="rect" id="node7" href="IR_2AffineExpr_8h.html" title="mlir/IR/AffineExpr.h" alt="" coords="4677,727,4823,754"/>
<area shape="rect" id="node8" href="Support_2LLVM_8h.html" title="mlir/Support/LLVM.h" alt="" coords="4392,809,4543,836"/>
<area shape="rect" id="node23" href="Dialect_2Linalg_2IR_2Linalg_8h.html" title="mlir/Dialect/Linalg\l/IR/Linalg.h" alt="" coords="3318,363,3459,404"/>
<area shape="rect" id="node25" href="PatternMatch_8h.html" title="mlir/IR/PatternMatch.h" alt="" coords="1792,549,1959,575"/>
<area shape="rect" id="node40" href="Dialect_2Linalg_2Passes_8h.html" title="mlir/Dialect/Linalg\l/Passes.h" alt="" coords="1661,95,1802,136"/>
<area shape="rect" id="node41" href="Dialect_2Linalg_2Transforms_2Transforms_8h.html" title="mlir/Dialect/Linalg\l/Transforms/Transforms.h" alt="" coords="2005,184,2191,225"/>
<area shape="rect" id="node43" href="Dialect_2Linalg_2Utils_2Utils_8h.html" title="mlir/Dialect/Linalg\l/Utils/Utils.h" alt="" coords="1661,273,1802,315"/>
<area shape="rect" id="node48" href="Dialect_2SparseTensor_2IR_2SparseTensor_8h.html" title="mlir/Dialect/SparseTensor\l/IR/SparseTensor.h" alt="" coords="117,452,305,493"/>
<area shape="rect" id="node49" href="Matchers_8h.html" title="mlir/IR/Matchers.h" alt="" coords="5,191,145,218"/>
<area shape="rect" id="node50" href="GreedyPatternRewriteDriver_8h.html" title="mlir/Transforms/GreedyPattern\lRewriteDriver.h" alt="" coords="5249,95,5470,136"/>
<area shape="rect" id="node11" href="IR_2Dialect_8h.html" title="mlir/IR/Dialect.h" alt="" coords="1589,549,1716,575"/>
<area shape="rect" id="node19" href="FuncOps_8h.html" title="mlir/Dialect/Func/IR\l/FuncOps.h" alt="" coords="360,363,508,404"/>
<area shape="rect" id="node20" href="BuiltinOps_8h.html" title="mlir/IR/BuiltinOps.h" alt="" coords="213,638,361,665"/>
<area shape="rect" id="node21" href="include_2mlir_2Pass_2Pass_8h.html" title="mlir/Pass/Pass.h" alt="" coords="1459,370,1585,397"/>
<area shape="rect" id="node5" href="AffineMemoryOpInterfaces_8h.html" title="mlir/Dialect/Affine\l/IR/AffineMemoryOpInterfaces.h" alt="" coords="1335,541,1565,583"/>
<area shape="rect" id="node10" href="Arithmetic_8h.html" title="mlir/Dialect/Arithmetic\l/IR/Arithmetic.h" alt="" coords="1162,452,1333,493"/>
<area shape="rect" id="node13" href="Builders_8h.html" title="mlir/IR/Builders.h" alt="" coords="1808,638,1943,665"/>
<area shape="rect" id="node15" href="ControlFlowInterfaces_8h.html" title="mlir/Interfaces/ControlFlow\lInterfaces.h" alt="" coords="1761,452,1960,493"/>
<area shape="rect" id="node16" href="LoopLikeInterface_8h.html" title="mlir/Interfaces/LoopLike\lInterface.h" alt="" coords="959,452,1138,493"/>
<area shape="rect" id="node9" href="IR_2BuiltinTypes_8h.html" title="mlir/IR/BuiltinTypes.h" alt="" coords="1497,638,1657,665"/>
<area shape="rect" id="node12" href="InferTypeOpInterface_8h.html" title="mlir/Interfaces/InferType\lOpInterface.h" alt="" coords="1079,541,1261,583"/>
<area shape="rect" id="node14" href="SideEffectInterfaces_8h.html" title="mlir/Interfaces/SideEffect\lInterfaces.h" alt="" coords="306,720,493,761"/>
<area shape="rect" id="node24" href="ReshapeOpsUtils_8h.html" title="mlir/Dialect/Utils\l/ReshapeOpsUtils.h" alt="" coords="2136,452,2284,493"/>
<area shape="rect" id="node26" href="StructuredOpsUtils_8h.html" title="mlir/Dialect/Utils\l/StructuredOpsUtils.h" alt="" coords="4433,541,4593,583"/>
<area shape="rect" id="node27" href="BuiltinDialect_8h.html" title="mlir/IR/BuiltinDialect.h" alt="" coords="3029,459,3199,486"/>
<area shape="rect" id="node28" href="ImplicitLocOpBuilder_8h.html" title="mlir/IR/ImplicitLocOpBuilder.h" alt="" coords="3528,549,3743,575"/>
<area shape="rect" id="node29" href="TypeUtilities_8h.html" title="mlir/IR/TypeUtilities.h" alt="" coords="4049,459,4211,486"/>
<area shape="rect" id="node30" href="CopyOpInterface_8h.html" title="mlir/Interfaces/CopyOpInterface.h" alt="" coords="2711,459,2954,486"/>
<area shape="rect" id="node31" href="TilingInterface_8h.html" title="mlir/Interfaces/TilingInterface.h" alt="" coords="2309,459,2535,486"/>
<area shape="rect" id="node32" href="ViewLikeInterface_8h.html" title="mlir/Interfaces/ViewLike\lInterface.h" alt="" coords="2497,541,2677,583"/>
<area shape="rect" id="node37" href="LinalgInterfaces_8h.html" title="mlir/Dialect/Linalg\l/IR/LinalgInterfaces.h" alt="" coords="3427,452,3585,493"/>
<area shape="rect" id="node33" href="StaticValueUtils_8h.html" title="mlir/Dialect/Utils\l/StaticValueUtils.h" alt="" coords="4397,631,4538,672"/>
<area shape="rect" id="node42" href="VectorToSCF_8h.html" title="mlir/Conversion/VectorTo\lSCF/VectorToSCF.h" alt="" coords="1826,273,2010,315"/>
<area shape="rect" id="node44" href="MemRef_8h.html" title="mlir/Dialect/MemRef\l/IR/MemRef.h" alt="" coords="2138,363,2293,404"/>
<area shape="rect" id="node45" href="Dialect_2SCF_2Utils_2Utils_8h.html" title="mlir/Dialect/SCF/Utils\l/Utils.h" alt="" coords="4913,452,5073,493"/>
<area shape="rect" id="node46" href="Dialect_2Tensor_2IR_2Tensor_8h.html" title="mlir/Dialect/Tensor\l/IR/Tensor.h" alt="" coords="1970,363,2114,404"/>
<area shape="rect" id="node47" href="VectorTransforms_8h.html" title="mlir/Dialect/Vector\l/Transforms/VectorTransforms.h" alt="" coords="3283,273,3510,315"/>
</map>
</div>
</div>
<p><a href="ElementwiseOpFusion_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19679bdb1cb388e2cf93c2dab27ffe52"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a19679bdb1cb388e2cf93c2dab27ffe52">getIndexingMapOfProducerOperandsInCoordinatesOfFusedOp</a> (<a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *producerOpOperand, <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> producerResultIndexMap, <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> fusedConsumerArgIndexMap)</td></tr>
<tr class="memdesc:a19679bdb1cb388e2cf93c2dab27ffe52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append to <code>fusedOpIndexingMapAttrs</code> the indexing maps for the operands of the <code>producer</code> to use in the fused operation given the indexing map of the result of the producer in the consumer.  <a href="#a19679bdb1cb388e2cf93c2dab27ffe52">More...</a><br /></td></tr>
<tr class="separator:a19679bdb1cb388e2cf93c2dab27ffe52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5db310021e942e1aebc58774be61a65"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#ad5db310021e942e1aebc58774be61a65">areElementwiseOpsFusable</a> (GenericOp producer, GenericOp consumer, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *consumerOpOperand)</td></tr>
<tr class="memdesc:ad5db310021e942e1aebc58774be61a65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conditions for elementwise fusion of generic operations.  <a href="#ad5db310021e942e1aebc58774be61a65">More...</a><br /></td></tr>
<tr class="separator:ad5db310021e942e1aebc58774be61a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42aab670a146bbd3928a9c54a9d18c3e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classvoid.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a42aab670a146bbd3928a9c54a9d18c3e">generateFusedElementwiseOpRegion</a> (<a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter, GenericOp fusedOp, <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> consumerToProducerLoopsMap, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *consumerOpOperand, <a class="el" href="classunsigned.html">unsigned</a> nloops)</td></tr>
<tr class="memdesc:a42aab670a146bbd3928a9c54a9d18c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the region of the fused tensor operation.  <a href="#a42aab670a146bbd3928a9c54a9d18c3e">More...</a><br /></td></tr>
<tr class="separator:a42aab670a146bbd3928a9c54a9d18c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54ecd6da31927ed907480e46322efc2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1Optional.html">Optional</a>&lt; <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="classmlir_1_1Value.html">Value</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#ad54ecd6da31927ed907480e46322efc2">fuseElementwiseOpsImpl</a> (GenericOp producer, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *consumerOpOperand, const <a class="el" href="namespacemlir_1_1linalg.html#ae7135470bdf5dc91445428d03b20e750">ControlFusionFn</a> &amp;controlFn, <a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter)</td></tr>
<tr class="separator:ad54ecd6da31927ed907480e46322efc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890d9d0e6359ba054164ea988d4c1997"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1Optional.html">Optional</a>&lt; <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="classmlir_1_1Value.html">Value</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a890d9d0e6359ba054164ea988d4c1997">fuseElementwiseOps</a> (<a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *consumerOpOperand, GenericOp producer, const <a class="el" href="namespacemlir_1_1linalg.html#ae7135470bdf5dc91445428d03b20e750">ControlFusionFn</a> &amp;controlFn)</td></tr>
<tr class="separator:a890d9d0e6359ba054164ea988d4c1997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cdb52727e15a09bab2229fd0b4f9155"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a9cdb52727e15a09bab2229fd0b4f9155">isFusableWithReshapeByDimExpansion</a> (GenericOp genericOp, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *fusableOpOperand)</td></tr>
<tr class="memdesc:a9cdb52727e15a09bab2229fd0b4f9155"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conditions for folding a generic operation with a reshape op by expanding the iteration space dimensionality for tensor operations.  <a href="#a9cdb52727e15a09bab2229fd0b4f9155">More...</a><br /></td></tr>
<tr class="separator:a9cdb52727e15a09bab2229fd0b4f9155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5333f824a21bffbb43276449d8affa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structmlir_1_1LogicalResult.html">LogicalResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a2f5333f824a21bffbb43276449d8affa">isGenericOpExpandable</a> (GenericOp genericOp, const ExpansionInfo &amp;expansionInfo, <a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter)</td></tr>
<tr class="memdesc:a2f5333f824a21bffbb43276449d8affa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Epanding the body of a linalg operation requires adaptations of the accessed loop indices.  <a href="#a2f5333f824a21bffbb43276449d8affa">More...</a><br /></td></tr>
<tr class="separator:a2f5333f824a21bffbb43276449d8affa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff1bcc53176a04b539b16e59cbac323e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#aff1bcc53176a04b539b16e59cbac323e">getIndexingMapInExpandedOp</a> (<a class="el" href="classmlir_1_1OpBuilder.html">OpBuilder</a> &amp;builder, <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, const ExpansionInfo &amp;expansionInfo)</td></tr>
<tr class="memdesc:aff1bcc53176a04b539b16e59cbac323e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the indexing map to use in the expanded op for a given the <code>indexingMap</code> of the original operation.  <a href="#aff1bcc53176a04b539b16e59cbac323e">More...</a><br /></td></tr>
<tr class="separator:aff1bcc53176a04b539b16e59cbac323e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ac3c8d820ffb7c2bde775b389c040c"><td class="memItemLeft" align="right" valign="top">static RankedTensorType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#af9ac3c8d820ffb7c2bde775b389c040c">getExpandedType</a> (RankedTensorType originalType, <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, const ExpansionInfo &amp;expansionInfo)</td></tr>
<tr class="memdesc:af9ac3c8d820ffb7c2bde775b389c040c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the type of the operand/result to use in the expanded op given the type in the original op.  <a href="#af9ac3c8d820ffb7c2bde775b389c040c">More...</a><br /></td></tr>
<tr class="separator:af9ac3c8d820ffb7c2bde775b389c040c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaaf23f77744995b559eea5f6f3beec3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#adaaf23f77744995b559eea5f6f3beec3">getReassociationForExpansion</a> (<a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, const ExpansionInfo &amp;expansionInfo)</td></tr>
<tr class="memdesc:adaaf23f77744995b559eea5f6f3beec3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the reassociation maps to use in the <code>tensor.expand_shape</code> operation to convert the operands of the original operation to operands of the expanded operation.  <a href="#adaaf23f77744995b559eea5f6f3beec3">More...</a><br /></td></tr>
<tr class="separator:adaaf23f77744995b559eea5f6f3beec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a500dd0360de9862e17d177987cb5a3f5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classvoid.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a500dd0360de9862e17d177987cb5a3f5">updateExpandedGenericOpRegion</a> (<a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter, <a class="el" href="classmlir_1_1Location.html">Location</a> loc, <a class="el" href="classmlir_1_1Region.html">Region</a> &amp;fusedRegion, const ExpansionInfo &amp;expansionInfo)</td></tr>
<tr class="memdesc:a500dd0360de9862e17d177987cb5a3f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the body of an expanded linalg operation having index semantics.  <a href="#a500dd0360de9862e17d177987cb5a3f5">More...</a><br /></td></tr>
<tr class="separator:a500dd0360de9862e17d177987cb5a3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a335d26611c359c111e9ea2b0fd4520aa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1Optional.html">Optional</a>&lt; <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="classmlir_1_1Value.html">Value</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a335d26611c359c111e9ea2b0fd4520aa">fuseWithReshapeByExpansion</a> (GenericOp genericOp, <a class="el" href="classmlir_1_1Operation.html">Operation</a> *reshapeOp, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *fusableOpOperand, <a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter)</td></tr>
<tr class="memdesc:a335d26611c359c111e9ea2b0fd4520aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the fusion of a tensor_collapse_shape or a tensor_expand_shape op and a generic op as explained in <code>isFusableWithReshapeByExpansion</code>.  <a href="#a335d26611c359c111e9ea2b0fd4520aa">More...</a><br /></td></tr>
<tr class="separator:a335d26611c359c111e9ea2b0fd4520aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d43306dd817ce8b48fe47442c5dc81"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#ac4d43306dd817ce8b48fe47442c5dc81">getDomainReassociation</a> (<a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, <a class="el" href="namespacemlir.html#a7ed845b40509fa999492a04654211321">ReassociationIndicesRef</a> rangeReassociation)</td></tr>
<tr class="memdesc:ac4d43306dd817ce8b48fe47442c5dc81"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a given list of indices in the range of the <code>indexingMap</code> that are folded, return the indices of the corresponding domain.  <a href="#ac4d43306dd817ce8b48fe47442c5dc81">More...</a><br /></td></tr>
<tr class="separator:ac4d43306dd817ce8b48fe47442c5dc81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe251ac8839eee6d5d0b764eac6f5cb0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#afe251ac8839eee6d5d0b764eac6f5cb0">isDimSequencePreserved</a> (<a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, <a class="el" href="namespacemlir.html#a7ed845b40509fa999492a04654211321">ReassociationIndicesRef</a> dimSequence)</td></tr>
<tr class="memdesc:afe251ac8839eee6d5d0b764eac6f5cb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a given <code>dimSequence</code>, check if the sequence is conserved in the <code>indexingMap</code>.  <a href="#afe251ac8839eee6d5d0b764eac6f5cb0">More...</a><br /></td></tr>
<tr class="separator:afe251ac8839eee6d5d0b764eac6f5cb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fb4f1d11a1227dc7fac2dda15a7305"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#ac9fb4f1d11a1227dc7fac2dda15a7305">getCollapsableIterationSpaceDims</a> (GenericOp genericOp, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *fusableOperand, <a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt; reassociation)</td></tr>
<tr class="separator:ac9fb4f1d11a1227dc7fac2dda15a7305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1adb5e0e7c0d1d4ef62b067014130c6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; StringRef &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#ab1adb5e0e7c0d1d4ef62b067014130c6">getCollapsedOpIteratorTypes</a> (<a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="classmlir_1_1Attribute.html">Attribute</a> &gt; iteratorTypes, const CollapsingInfo &amp;collapsingInfo)</td></tr>
<tr class="memdesc:ab1adb5e0e7c0d1d4ef62b067014130c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the iterator types for the collapsed operation given the original iterator types and collapsed dimensions.  <a href="#ab1adb5e0e7c0d1d4ef62b067014130c6">More...</a><br /></td></tr>
<tr class="separator:ab1adb5e0e7c0d1d4ef62b067014130c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4c97564506872801e2cf3f284f6eb8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#adf4c97564506872801e2cf3f284f6eb8">getCollapsedOpIndexingMap</a> (<a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, const CollapsingInfo &amp;collapsingInfo)</td></tr>
<tr class="memdesc:adf4c97564506872801e2cf3f284f6eb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the indexing map in the collapsed op that corresponds to the given <code>indexingMap</code> of the original operation.  <a href="#adf4c97564506872801e2cf3f284f6eb8">More...</a><br /></td></tr>
<tr class="separator:adf4c97564506872801e2cf3f284f6eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a196f071bfe14a50919431c360987f346"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a196f071bfe14a50919431c360987f346">getOperandReassociation</a> (<a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> indexingMap, const CollapsingInfo &amp;collapsingInfo)</td></tr>
<tr class="memdesc:a196f071bfe14a50919431c360987f346"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the <code>reassociation</code> indices to use to collapse the operand when the iteration space of a generic op is collapsed.  <a href="#a196f071bfe14a50919431c360987f346">More...</a><br /></td></tr>
<tr class="separator:a196f071bfe14a50919431c360987f346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0a250d38e35a37ac5693bbba2496cc"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmlir_1_1Value.html">Value</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a7c0a250d38e35a37ac5693bbba2496cc">getCollapsedOpOperand</a> (<a class="el" href="classmlir_1_1Location.html">Location</a> loc, GenericOp genericOp, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *opOperand, const CollapsingInfo &amp;collapsingInfo, <a class="el" href="classmlir_1_1OpBuilder.html">OpBuilder</a> &amp;builder)</td></tr>
<tr class="memdesc:a7c0a250d38e35a37ac5693bbba2496cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the new value to use for a given <code>OpOperand</code> in the collapsed operation.  <a href="#a7c0a250d38e35a37ac5693bbba2496cc">More...</a><br /></td></tr>
<tr class="separator:a7c0a250d38e35a37ac5693bbba2496cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e393f7b5964266cf892ababb7b85c72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvoid.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#a4e393f7b5964266cf892ababb7b85c72">generateCollapsedIndexingRegion</a> (<a class="el" href="classmlir_1_1Location.html">Location</a> loc, <a class="el" href="classmlir_1_1Block.html">Block</a> *block, const CollapsingInfo &amp;collapsingInfo, <a class="el" href="classmlir_1_1ValueRange.html">ValueRange</a> loopRange, <a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter)</td></tr>
<tr class="memdesc:a4e393f7b5964266cf892ababb7b85c72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify the <code>linalg.index</code> operations in the original generic op, to its value in the collapsed operation.  <a href="#a4e393f7b5964266cf892ababb7b85c72">More...</a><br /></td></tr>
<tr class="separator:a4e393f7b5964266cf892ababb7b85c72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac24b9f4d3b3a2917ae62c6c7901cb5d8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmlir_1_1FailureOr.html">FailureOr</a>&lt; <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; <a class="el" href="classmlir_1_1Value.html">Value</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ElementwiseOpFusion_8cpp.html#ac24b9f4d3b3a2917ae62c6c7901cb5d8">collapseGenericOpIterationDims</a> (GenericOp genericOp, <a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt; foldedIterationDims, <a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *fusableOpOperand, <a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;rewriter)</td></tr>
<tr class="memdesc:ac24b9f4d3b3a2917ae62c6c7901cb5d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of fusion with reshape operation by collapsing dimensions.  <a href="#ac24b9f4d3b3a2917ae62c6c7901cb5d8">More...</a><br /></td></tr>
<tr class="separator:ac24b9f4d3b3a2917ae62c6c7901cb5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad5db310021e942e1aebc58774be61a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5db310021e942e1aebc58774be61a65">&#9670;&nbsp;</a></span>areElementwiseOpsFusable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool areElementwiseOpsFusable </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>producer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>consumer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>consumerOpOperand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Conditions for elementwise fusion of generic operations. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00068">68</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="UseDefLists_8h_source.html#l00133">mlir::IROperand&lt; DerivedT, IRValueT &gt;::get()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00038">getIndexingMapOfProducerOperandsInCoordinatesOfFusedOp()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00302">mlir::AffineMap::getNumResults()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00508">mlir::AffineMap::isPermutation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00250">fuseElementwiseOpsImpl()</a>.</p>

</div>
</div>
<a id="ac24b9f4d3b3a2917ae62c6c7901cb5d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac24b9f4d3b3a2917ae62c6c7901cb5d8">&#9670;&nbsp;</a></span>collapseGenericOpIterationDims()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classmlir_1_1FailureOr.html">FailureOr</a>&lt;<a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="classmlir_1_1Value.html">Value</a>&gt; &gt; collapseGenericOpIterationDims </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>genericOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt;&#160;</td>
          <td class="paramname"><em>foldedIterationDims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>fusableOpOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implementation of fusion with reshape operation by collapsing dimensions. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">1330</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2Region_8h_source.html#l00055">mlir::Region::begin()</a>, <a class="el" href="Block_8h_source.html#l00134">mlir::Block::begin()</a>, <a class="el" href="PatternMatch_8h_source.html#l00493">mlir::RewriterBase::cancelRootUpdate()</a>, <a class="el" href="IR_2Types_8h_source.html#l00250">mlir::Type::cast()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00351">mlir::RewriterBase::cloneRegionBefore()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00703">mlir::concatAffineMaps()</a>, <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="Builders_8h_source.html#l00451">mlir::OpBuilder::createOrFold()</a>, <a class="el" href="Attributes_8h_source.html#l00124">mlir::Attribute::dyn_cast()</a>, <a class="el" href="IR_2Types_8h_source.html#l00244">mlir::Type::dyn_cast()</a>, <a class="el" href="Matchers_8h_source.html#l00234">mlir::detail::enumerate()</a>, <a class="el" href="LogicalResult_8h_source.html#l00072">mlir::failed()</a>, <a class="el" href="LogicalResult_8h_source.html#l00062">mlir::failure()</a>, <a class="el" href="PatternMatch_8h_source.html#l00489">mlir::RewriterBase::finalizeRootUpdate()</a>, <a class="el" href="Block_8h_source.html#l00144">mlir::Block::front()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01291">generateCollapsedIndexingRegion()</a>, <a class="el" href="Builders_8cpp_source.html#l00258">mlir::Builder::getAffineMapArrayAttr()</a>, <a class="el" href="Block_8h_source.html#l00120">mlir::Block::getArgument()</a>, <a class="el" href="Block_8h_source.html#l00076">mlir::Block::getArguments()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01005">getCollapsableIterationSpaceDims()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01217">getCollapsedOpIndexingMap()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01198">getCollapsedOpIteratorTypes()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01269">getCollapsedOpOperand()</a>, <a class="el" href="Value_8cpp_source.html#l00020">mlir::Value::getDefiningOp()</a>, <a class="el" href="Builders_8cpp_source.html#l00028">mlir::Builder::getFusedLoc()</a>, <a class="el" href="Value_8cpp_source.html#l00026">mlir::Value::getLoc()</a>, <a class="el" href="IR_2Operation_8h_source.html#l00161">mlir::Operation::getLoc()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01242">getOperandReassociation()</a>, <a class="el" href="SparseTensorDialect_8cpp_source.html#l00184">mlir::sparse_tensor::getSparseTensorEncoding()</a>, <a class="el" href="IR_2BuiltinAttributes_8h_source.html#l00382">mlir::DenseElementsAttr::getSplatValue()</a>, <a class="el" href="Attributes_8h_source.html#l00066">mlir::Attribute::getType()</a>, <a class="el" href="Value_8h_source.html#l00118">mlir::Value::getType()</a>, <a class="el" href="IR_2BuiltinAttributes_8cpp_source.html#l01010">mlir::DenseElementsAttr::getType()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00658">mlir::inversePermutation()</a>, <a class="el" href="IR_2BuiltinAttributes_8cpp_source.html#l00877">mlir::DenseElementsAttr::isSplat()</a>, <a class="el" href="Matchers_8h_source.html#l00321">mlir::m_One()</a>, <a class="el" href="Matchers_8h_source.html#l00310">mlir::m_Zero()</a>, <a class="el" href="BlockAndValueMapping_8h_source.html#l00030">mlir::BlockAndValueMapping::map()</a>, <a class="el" href="Matchers_8h_source.html#l00333">mlir::matchPattern()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00277">mlir::RewriterBase::mergeBlocks()</a>, <a class="el" href="PatternMatch_8h_source.html#l00512">mlir::RewriterBase::notifyMatchFailure()</a>, <a class="el" href="ViewLikeInterface_8h_source.html#l00027">mlir::Range::offset</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00245">mlir::RewriterBase::replaceOp()</a>, <a class="el" href="Builders_8h_source.html#l00329">mlir::OpBuilder::setInsertionPoint()</a>, <a class="el" href="IR_2Operation_8h_source.html#l00274">mlir::Operation::setOperand()</a>, <a class="el" href="ViewLikeInterface_8h_source.html#l00028">mlir::Range::size</a>, <a class="el" href="PatternMatch_8h_source.html#l00484">mlir::RewriterBase::startRootUpdate()</a>, <a class="el" href="ViewLikeInterface_8h_source.html#l00029">mlir::Range::stride</a>, and <a class="el" href="LogicalResult_8h_source.html#l00056">mlir::success()</a>.</p>

</div>
</div>
<a id="a890d9d0e6359ba054164ea988d4c1997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a890d9d0e6359ba054164ea988d4c1997">&#9670;&nbsp;</a></span>fuseElementwiseOps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1Optional.html">Optional</a>&lt;<a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="classmlir_1_1Value.html">Value</a>&gt; &gt; fuseElementwiseOps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>consumerOpOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>producer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemlir_1_1linalg.html#ae7135470bdf5dc91445428d03b20e750">ControlFusionFn</a> &amp;&#160;</td>
          <td class="paramname"><em>controlFn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00354">354</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="LogicalResult_8h_source.html#l00062">mlir::failure()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00250">fuseElementwiseOpsImpl()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00245">mlir::RewriterBase::replaceOp()</a>, and <a class="el" href="LogicalResult_8h_source.html#l00056">mlir::success()</a>.</p>

</div>
</div>
<a id="ad54ecd6da31927ed907480e46322efc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad54ecd6da31927ed907480e46322efc2">&#9670;&nbsp;</a></span>fuseElementwiseOpsImpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1Optional.html">Optional</a>&lt;<a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="classmlir_1_1Value.html">Value</a>&gt; &gt; fuseElementwiseOpsImpl </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>producer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>consumerOpOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemlir_1_1linalg.html#ae7135470bdf5dc91445428d03b20e750">ControlFusionFn</a> &amp;&#160;</td>
          <td class="paramname"><em>controlFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00250">250</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00068">areElementwiseOpsFusable()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00439">mlir::AffineMap::compose()</a>, <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00259">mlir::RewriterBase::eraseOp()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00139">generateFusedElementwiseOpRegion()</a>, <a class="el" href="Builders_8cpp_source.html#l00258">mlir::Builder::getAffineMapArrayAttr()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00038">getIndexingMapOfProducerOperandsInCoordinatesOfFusedOp()</a>, <a class="el" href="UseDefLists_8h_source.html#l00037">mlir::detail::IROperandBase::getOwner()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00658">mlir::inversePermutation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00354">fuseElementwiseOps()</a>.</p>

</div>
</div>
<a id="a335d26611c359c111e9ea2b0fd4520aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a335d26611c359c111e9ea2b0fd4520aa">&#9670;&nbsp;</a></span>fuseWithReshapeByExpansion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1Optional.html">Optional</a>&lt;<a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="classmlir_1_1Value.html">Value</a>&gt; &gt; fuseWithReshapeByExpansion </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>genericOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1Operation.html">Operation</a> *&#160;</td>
          <td class="paramname"><em>reshapeOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>fusableOpOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements the fusion of a tensor_collapse_shape or a tensor_expand_shape op and a generic op as explained in <code>isFusableWithReshapeByExpansion</code>. </p>
<p>Assumes that those conditions have been satisfied. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">684</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2Region_8h_source.html#l00055">mlir::Region::begin()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00351">mlir::RewriterBase::cloneRegionBefore()</a>, <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="LogicalResult_8h_source.html#l00072">mlir::failed()</a>, <a class="el" href="LogicalResult_8h_source.html#l00062">mlir::failure()</a>, <a class="el" href="MLIRContext_8cpp_source.html#l00980">mlir::AffineMap::get()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00603">getExpandedType()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00585">getIndexingMapInExpandedOp()</a>, <a class="el" href="StructuredOpsUtils_8h_source.html#l00080">mlir::getParallelIteratorTypeName()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00622">getReassociationForExpansion()</a>, <a class="el" href="OperationSupport_8h_source.html#l01162">mlir::ValueRange::getTypes()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00453">isFusableWithReshapeByDimExpansion()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00563">isGenericOpExpandable()</a>, <a class="el" href="PatternMatch_8h_source.html#l00512">mlir::RewriterBase::notifyMatchFailure()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00245">mlir::RewriterBase::replaceOp()</a>, <a class="el" href="ReshapeOpsUtils_8cpp_source.html#l00226">mlir::reshapeLikeShapesAreCompatible()</a>, <a class="el" href="LogicalResult_8h_source.html#l00056">mlir::success()</a>, and <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00642">updateExpandedGenericOpRegion()</a>.</p>

</div>
</div>
<a id="a4e393f7b5964266cf892ababb7b85c72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e393f7b5964266cf892ababb7b85c72">&#9670;&nbsp;</a></span>generateCollapsedIndexingRegion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classvoid.html">void</a> generateCollapsedIndexingRegion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1Location.html">Location</a>&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1Block.html">Block</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CollapsingInfo &amp;&#160;</td>
          <td class="paramname"><em>collapsingInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1ValueRange.html">ValueRange</a>&#160;</td>
          <td class="paramname"><em>loopRange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modify the <code>linalg.index</code> operations in the original generic op, to its value in the collapsed operation. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01291">1291</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="Matchers_8h_source.html#l00234">mlir::detail::enumerate()</a>, <a class="el" href="Block_8h_source.html#l00184">mlir::Block::getOps()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00245">mlir::RewriterBase::replaceOp()</a>, and <a class="el" href="Builders_8h_source.html#l00362">mlir::OpBuilder::setInsertionPointToStart()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">collapseGenericOpIterationDims()</a>.</p>

</div>
</div>
<a id="a42aab670a146bbd3928a9c54a9d18c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42aab670a146bbd3928a9c54a9d18c3e">&#9670;&nbsp;</a></span>generateFusedElementwiseOpRegion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classvoid.html">void</a> generateFusedElementwiseOpRegion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>fusedOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>consumerToProducerLoopsMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>consumerOpOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>nloops</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate the region of the fused tensor operation. </p>
<p>The region of the fused op must be empty. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00139">139</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="Block_8cpp_source.html#l00141">mlir::Block::addArgument()</a>, <a class="el" href="Builders_8cpp_source.html#l00468">mlir::OpBuilder::clone()</a>, <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="Value_8h_source.html#l00100">mlir::Value::dyn_cast()</a>, <a class="el" href="Block_8h_source.html#l00144">mlir::Block::front()</a>, <a class="el" href="UseDefLists_8h_source.html#l00133">mlir::IROperand&lt; DerivedT, IRValueT &gt;::get()</a>, <a class="el" href="Block_8h_source.html#l00120">mlir::Block::getArgument()</a>, <a class="el" href="Block_8h_source.html#l00076">mlir::Block::getArguments()</a>, <a class="el" href="Value_8cpp_source.html#l00020">mlir::Value::getDefiningOp()</a>, <a class="el" href="Value_8h_source.html#l00315">mlir::BlockArgument::getLoc()</a>, <a class="el" href="Block_8h_source.html#l00119">mlir::Block::getNumArguments()</a>, <a class="el" href="Value_8cpp_source.html#l00212">mlir::OpOperand::getOperandNumber()</a>, <a class="el" href="Block_8h_source.html#l00128">mlir::Block::getOperations()</a>, <a class="el" href="UseDefLists_8h_source.html#l00037">mlir::detail::IROperandBase::getOwner()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00514">mlir::AffineMap::getSubMap()</a>, <a class="el" href="Value_8h_source.html#l00118">mlir::Value::getType()</a>, <a class="el" href="BlockAndValueMapping_8h_source.html#l00059">mlir::BlockAndValueMapping::lookupOrDefault()</a>, <a class="el" href="BlockAndValueMapping_8h_source.html#l00030">mlir::BlockAndValueMapping::map()</a>, <a class="el" href="PolynomialApproximation_8cpp_source.html#l00193">max()</a>, and <a class="el" href="Builders_8h_source.html#l00362">mlir::OpBuilder::setInsertionPointToStart()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00250">fuseElementwiseOpsImpl()</a>.</p>

</div>
</div>
<a id="ac9fb4f1d11a1227dc7fac2dda15a7305"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fb4f1d11a1227dc7fac2dda15a7305">&#9670;&nbsp;</a></span>getCollapsableIterationSpaceDims()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a>&gt; getCollapsableIterationSpaceDims </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>genericOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>fusableOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> &gt;&#160;</td>
          <td class="paramname"><em>reassociation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01005">1005</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="Matchers_8h_source.html#l00234">mlir::detail::enumerate()</a>, <a class="el" href="LogicalResult_8h_source.html#l00062">mlir::failure()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00898">getDomainReassociation()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00917">isDimSequencePreserved()</a>, <a class="el" href="StructuredOpsUtils_8h_source.html#l00081">mlir::isParallelIterator()</a>, and <a class="el" href="StructuredOpsUtils_8h_source.html#l00088">mlir::isReductionIterator()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">collapseGenericOpIterationDims()</a>.</p>

</div>
</div>
<a id="adf4c97564506872801e2cf3f284f6eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4c97564506872801e2cf3f284f6eb8">&#9670;&nbsp;</a></span>getCollapsedOpIndexingMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> getCollapsedOpIndexingMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CollapsingInfo &amp;&#160;</td>
          <td class="paramname"><em>collapsingInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the indexing map in the collapsed op that corresponds to the given <code>indexingMap</code> of the original operation. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01217">1217</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="MLIRContext_8cpp_source.html#l00980">mlir::AffineMap::get()</a>, <a class="el" href="IR_2AffineExpr_8cpp_source.html#l00489">mlir::getAffineDimExpr()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00253">mlir::AffineMap::getContext()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00478">mlir::AffineMap::isProjectedPermutation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">collapseGenericOpIterationDims()</a>.</p>

</div>
</div>
<a id="ab1adb5e0e7c0d1d4ef62b067014130c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1adb5e0e7c0d1d4ef62b067014130c6">&#9670;&nbsp;</a></span>getCollapsedOpIteratorTypes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;StringRef&gt; getCollapsedOpIteratorTypes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="classmlir_1_1Attribute.html">Attribute</a> &gt;&#160;</td>
          <td class="paramname"><em>iteratorTypes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CollapsingInfo &amp;&#160;</td>
          <td class="paramname"><em>collapsingInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the iterator types for the collapsed operation given the original iterator types and collapsed dimensions. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01198">1198</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">collapseGenericOpIterationDims()</a>.</p>

</div>
</div>
<a id="a7c0a250d38e35a37ac5693bbba2496cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0a250d38e35a37ac5693bbba2496cc">&#9670;&nbsp;</a></span>getCollapsedOpOperand()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classmlir_1_1Value.html">Value</a> getCollapsedOpOperand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1Location.html">Location</a>&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>genericOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>opOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CollapsingInfo &amp;&#160;</td>
          <td class="paramname"><em>collapsingInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpBuilder.html">OpBuilder</a> &amp;&#160;</td>
          <td class="paramname"><em>builder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the new value to use for a given <code>OpOperand</code> in the collapsed operation. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01269">1269</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="UseDefLists_8h_source.html#l00133">mlir::IROperand&lt; DerivedT, IRValueT &gt;::get()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00302">mlir::AffineMap::getNumResults()</a>, <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01242">getOperandReassociation()</a>, and <a class="el" href="IR_2Operation_8h_source.html#l00330">mlir::Operation::getResult()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">collapseGenericOpIterationDims()</a>.</p>

</div>
</div>
<a id="ac4d43306dd817ce8b48fe47442c5dc81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4d43306dd817ce8b48fe47442c5dc81">&#9670;&nbsp;</a></span>getDomainReassociation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a> getDomainReassociation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemlir.html#a7ed845b40509fa999492a04654211321">ReassociationIndicesRef</a>&#160;</td>
          <td class="paramname"><em>rangeReassociation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For a given list of indices in the range of the <code>indexingMap</code> that are folded, return the indices of the corresponding domain. </p>
<p>Return <code>llvm::None</code> on failure. Ensures that all the elements of the returned reassociation are distinct. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00898">898</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00478">mlir::AffineMap::isProjectedPermutation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01005">getCollapsableIterationSpaceDims()</a>.</p>

</div>
</div>
<a id="af9ac3c8d820ffb7c2bde775b389c040c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ac3c8d820ffb7c2bde775b389c040c">&#9670;&nbsp;</a></span>getExpandedType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static RankedTensorType getExpandedType </td>
          <td>(</td>
          <td class="paramtype">RankedTensorType&#160;</td>
          <td class="paramname"><em>originalType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ExpansionInfo &amp;&#160;</td>
          <td class="paramname"><em>expansionInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the type of the operand/result to use in the expanded op given the type in the original op. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00603">603</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">fuseWithReshapeByExpansion()</a>.</p>

</div>
</div>
<a id="aff1bcc53176a04b539b16e59cbac323e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff1bcc53176a04b539b16e59cbac323e">&#9670;&nbsp;</a></span>getIndexingMapInExpandedOp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> getIndexingMapInExpandedOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpBuilder.html">OpBuilder</a> &amp;&#160;</td>
          <td class="paramname"><em>builder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ExpansionInfo &amp;&#160;</td>
          <td class="paramname"><em>expansionInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the indexing map to use in the expanded op for a given the <code>indexingMap</code> of the original operation. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00585">585</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="MLIRContext_8cpp_source.html#l00980">mlir::AffineMap::get()</a>, <a class="el" href="Builders_8cpp_source.html#l00285">mlir::Builder::getAffineDimExpr()</a>, <a class="el" href="Builders_8h_source.html#l00054">mlir::Builder::getContext()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00298">mlir::AffineMap::getNumSymbols()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">fuseWithReshapeByExpansion()</a>.</p>

</div>
</div>
<a id="a19679bdb1cb388e2cf93c2dab27ffe52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19679bdb1cb388e2cf93c2dab27ffe52">&#9670;&nbsp;</a></span>getIndexingMapOfProducerOperandsInCoordinatesOfFusedOp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a> getIndexingMapOfProducerOperandsInCoordinatesOfFusedOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>producerOpOperand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>producerResultIndexMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>fusedConsumerArgIndexMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Append to <code>fusedOpIndexingMapAttrs</code> the indexing maps for the operands of the <code>producer</code> to use in the fused operation given the indexing map of the result of the producer in the consumer. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00038">38</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2AffineMap_8cpp_source.html#l00439">mlir::AffineMap::compose()</a>, <a class="el" href="UseDefLists_8h_source.html#l00037">mlir::detail::IROperandBase::getOwner()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00658">mlir::inversePermutation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00068">areElementwiseOpsFusable()</a>, and <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00250">fuseElementwiseOpsImpl()</a>.</p>

</div>
</div>
<a id="a196f071bfe14a50919431c360987f346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a196f071bfe14a50919431c360987f346">&#9670;&nbsp;</a></span>getOperandReassociation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a>&gt; getOperandReassociation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CollapsingInfo &amp;&#160;</td>
          <td class="paramname"><em>collapsingInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the <code>reassociation</code> indices to use to collapse the operand when the iteration space of a generic op is collapsed. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01242">1242</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2AffineExpr_8h_source.html#l00291">mlir::AffineExpr::cast()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00302">mlir::AffineMap::getNumResults()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00311">mlir::AffineMap::getResult()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01330">collapseGenericOpIterationDims()</a>, and <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01269">getCollapsedOpOperand()</a>.</p>

</div>
</div>
<a id="adaaf23f77744995b559eea5f6f3beec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaaf23f77744995b559eea5f6f3beec3">&#9670;&nbsp;</a></span>getReassociationForExpansion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt;<a class="el" href="namespacemlir.html#ab973fb931221b9539fe0ffd408e261ff">ReassociationIndices</a>&gt; getReassociationForExpansion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ExpansionInfo &amp;&#160;</td>
          <td class="paramname"><em>expansionInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the reassociation maps to use in the <code>tensor.expand_shape</code> operation to convert the operands of the original operation to operands of the expanded operation. </p>
<p>The same method is used to compute the <code>tensor.collapse_shape</code> used to collapse the result of the expanded op to get the value that can replace all uses of the results of the original op. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00622">622</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">fuseWithReshapeByExpansion()</a>.</p>

</div>
</div>
<a id="afe251ac8839eee6d5d0b764eac6f5cb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe251ac8839eee6d5d0b764eac6f5cb0">&#9670;&nbsp;</a></span>isDimSequencePreserved()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool isDimSequencePreserved </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1AffineMap.html">AffineMap</a>&#160;</td>
          <td class="paramname"><em>indexingMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemlir.html#a7ed845b40509fa999492a04654211321">ReassociationIndicesRef</a>&#160;</td>
          <td class="paramname"><em>dimSequence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For a given <code>dimSequence</code>, check if the sequence is conserved in the <code>indexingMap</code>. </p>
<p><code>indexingMap</code> is expected to be a projected permutation. Non-existence of the sequence returns true as well. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00917">917</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="Matchers_8h_source.html#l00234">mlir::detail::enumerate()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00302">mlir::AffineMap::getNumResults()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00311">mlir::AffineMap::getResult()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>, and <a class="el" href="IR_2AffineMap_8cpp_source.html#l00478">mlir::AffineMap::isProjectedPermutation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l01005">getCollapsableIterationSpaceDims()</a>.</p>

</div>
</div>
<a id="a9cdb52727e15a09bab2229fd0b4f9155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cdb52727e15a09bab2229fd0b4f9155">&#9670;&nbsp;</a></span>isFusableWithReshapeByDimExpansion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool isFusableWithReshapeByDimExpansion </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>genericOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1OpOperand.html">OpOperand</a> *&#160;</td>
          <td class="paramname"><em>fusableOpOperand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Conditions for folding a generic operation with a reshape op by expanding the iteration space dimensionality for tensor operations. </p>
<p>These are preconditions assumed by <code>foldReshapeByDimExpansion</code> which implements the following fusion pattern.</p>
<p>Consider</p>
<p>c = linalg.generic ins(a, b : memref&lt;?x?x?xf32&gt;, memref&lt;?x?xf32&gt;) indexing_maps = [affine_map&lt;(d0, d1, d2) -&gt; (d1, d0, d2)&gt;, affine_map&lt;(d0, d1, d2) -&gt; (d1, d2)&gt;, affine_map&lt;(d0, d1, d2) -&gt; (d0, d2, d1)&gt;] d = tensor.expand_shape c [[0, 1], [2], [3, 4, 5]] : tensor&lt;?x?x?xf32&gt; into tensor&lt;?x?x?x?x?x?xf32&gt;</p>
<p>The reshape can be folded into the <code>genericOp</code> if its loop dimensionality is increased to match the result (operand) of the tensor_expand_shape. The indexing_map of the fused tensor in the <code>genericOp</code> and the reassociation map helps compute the indexing maps of the modified op. For the above example, based on the reassociation map it can be concluded that</p>
<ul>
<li>The loop used to access the first dimension of the fused tensor is split into two.</li>
<li>The loop used to access the second dimension of the fused tensor is kept as is.</li>
<li>The loop used to access the third dimension of the fused tensor is split into three.</li>
</ul>
<p>i.e. (e0, e1, e2, e3, e4) is the domain of the indexing map of the modified op, then</p>
<p>d0 -&gt; e0, e1 d1 -&gt; e2, e3, e4 d2 -&gt; e5</p>
<p>substituting this, the generic op can be rewritten as</p>
<p>d = linalg.generic ins(%0, %1 : ) indexing_maps = [affine_map&lt;(e0, e1, e2, e3, e4, e5) -&gt; (e2, e3, e4, e0, e1, e5)&gt;, affine_map&lt;(e0, e1, e2, e3, e4, e5) -&gt; (e2, e3, e4, e5)&gt;, affine_map&lt;(e0, e1, e2, e3, e4, e5) -&gt; (e0, e1, e5, e2, e3, e4)&gt;]</p>
<p>Since operands to the linalg generic are now 5D, reshapes can be introduced to make it consistent</p>
<p>%0 = tensor.expand_shape a [[0, 1, 2], [3, 4], [5]] : tensor&lt;?x?x?xf32&gt; into tensor&lt;?x?x?x?x?x?xf32&gt; %1 = tensor.expand_shape b [[0, 1, 2], [3]] : tensor&lt;?x?x?xf32&gt; into tensor&lt;?x?x?x?xf32&gt;</p>
<p>The added reshapes are again expanding patterns, so they will get fused with its producers if possible. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00453">453</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="Matchers_8h_source.html#l00234">mlir::detail::enumerate()</a>, <a class="el" href="LogicalResult_8h_source.html#l00062">mlir::failure()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00315">mlir::AffineMap::getDimPosition()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00294">mlir::AffineMap::getNumDims()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00302">mlir::AffineMap::getNumResults()</a>, <a class="el" href="StructuredOpsUtils_8h_source.html#l00080">mlir::getParallelIteratorTypeName()</a>, <a class="el" href="IR_2AffineMap_8cpp_source.html#l00307">mlir::AffineMap::getResults()</a>, and <a class="el" href="LogicalResult_8h_source.html#l00056">mlir::success()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">fuseWithReshapeByExpansion()</a>.</p>

</div>
</div>
<a id="a2f5333f824a21bffbb43276449d8affa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f5333f824a21bffbb43276449d8affa">&#9670;&nbsp;</a></span>isGenericOpExpandable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structmlir_1_1LogicalResult.html">LogicalResult</a> isGenericOpExpandable </td>
          <td>(</td>
          <td class="paramtype">GenericOp&#160;</td>
          <td class="paramname"><em>genericOp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ExpansionInfo &amp;&#160;</td>
          <td class="paramname"><em>expansionInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Epanding the body of a linalg operation requires adaptations of the accessed loop indices. </p>
<p>Specifically, access of indices in the original operation need to be replaced with linearizations of indices in the expanded op. That requires the shape of the expanded dimensions to be static (at least all but the most significant). For now check that these are all statically sized. Note that this could be extended to handle dynamic case, but the implementation below uses <code>affine.apply</code> which seems to have issues when the shapes are not static. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00563">563</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="PatternMatch_8h_source.html#l00512">mlir::RewriterBase::notifyMatchFailure()</a>, and <a class="el" href="LogicalResult_8h_source.html#l00056">mlir::success()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">fuseWithReshapeByExpansion()</a>.</p>

</div>
</div>
<a id="a500dd0360de9862e17d177987cb5a3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a500dd0360de9862e17d177987cb5a3f5">&#9670;&nbsp;</a></span>updateExpandedGenericOpRegion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classvoid.html">void</a> updateExpandedGenericOpRegion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1PatternRewriter.html">PatternRewriter</a> &amp;&#160;</td>
          <td class="paramname"><em>rewriter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1Location.html">Location</a>&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmlir_1_1Region.html">Region</a> &amp;&#160;</td>
          <td class="paramname"><em>fusedRegion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ExpansionInfo &amp;&#160;</td>
          <td class="paramname"><em>expansionInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the body of an expanded linalg operation having index semantics. </p>
<p>The indices of the original operation need to be recovered by linearizing the indices of the correspoding dimensions of the expanded operation. For now it is assumed that the shapes of the expanded operation needed for linearization are static. </p>

<p class="definition">Definition at line <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00642">642</a> of file <a class="el" href="ElementwiseOpFusion_8cpp_source.html">ElementwiseOpFusion.cpp</a>.</p>

<p class="reference">References <a class="el" href="IR_2AffineExpr_8h_source.html#l00328">mlir::bindDims()</a>, <a class="el" href="Builders_8cpp_source.html#l00380">mlir::OpBuilder::create()</a>, <a class="el" href="IR_2Region_8h_source.html#l00065">mlir::Region::front()</a>, <a class="el" href="Builders_8h_source.html#l00054">mlir::Builder::getContext()</a>, <a class="el" href="Block_8h_source.html#l00184">mlir::Block::getOps()</a>, <a class="el" href="PatternMatch_8cpp_source.html#l00245">mlir::RewriterBase::replaceOp()</a>, and <a class="el" href="Builders_8h_source.html#l00343">mlir::OpBuilder::setInsertionPointAfter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ElementwiseOpFusion_8cpp_source.html#l00684">fuseWithReshapeByExpansion()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 4 2022 20:33:01 for MLIR by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
